<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Hello Solana World </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Hello Solana World ">
    <meta name="generator" content="docfx 2.58.0.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/night-owl.min.css">
    <link rel="stylesheet" href="../styles/colors.css">
    <link rel="stylesheet" href="../styles/discord.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>

  <body>
        <div class="top-navbar">

            <a href="javascript:void(0);" class="burger-icon" onclick="toggleMenu()">
                <svg name="Hamburger" style="vertical-align: middle;" width="24" height="24" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M20 6H4V9H20V6ZM4 10.999H20V13.999H4V10.999ZM4 15.999H20V18.999H4V15.999Z"></path></svg>
            </a>

            
            <a class="brand" href="../index.html">
              <img src="../logo.png" alt="" class="logomark">
              <span class="brand-title"></span>
            </a>
        </div>

        <div class="body-content">

            <div id="blackout" class="blackout" onclick="toggleMenu()"></div>

            <nav id="sidebar" role="navigation">

                <div class="sidebar">
                    
                    
                    
                    
                    <div>
                      
                      <a class="brand" href="../index.html">
                        <img src="../logo.png" alt="" class="logomark">
                        <span class="brand-title"></span>
                      </a>
                      <div id="navbar">
                    
                      </div>
                    
                    </div>
                    

                    <div class="sidebar-item-separator"></div>

                        
                        <div id="sidetoggle">
                          <div id="sidetoc"></div>
                        </div>

                </div>

                <div class="footer">
                  
                  <span>Generated by <strong>DocFX</strong></span>
                </div>
            </nav>

            <main class="main-panel">

                <div role="main" class="hide-when-search">

                        
                        <div class="subnav navbar navbar-default">
                          <div class="container hide-when-search" id="breadcrumb">
                            <ul class="breadcrumb">
                              <li></li>
                            </ul>
                          </div>
                        </div>

                    <article class="content wrap" id="_content" data-uid="">
<h1 id="hello-solana-world">Hello Solana World</h1>

<p>In this article we're going to be diving step-by-step on how you can create an hello world using Solana.Unity. In this specific example, you are to learn how to create a wallet, request an airdrop (testnet functionality), and transfer funds.</p>
<h2 id="1--creating-project-and-linking-dependencies">1- Creating project and linking dependencies</h2>
<p>To start, we're going to create a new dotnet console project using:</p>
<pre><code>dotnet new console
</code></pre>
<p>Now we have to add Solana.Unity as a dependency to the project:</p>
<pre><code>dotnet add package Solana.Unity.Rpc
</code></pre>
<p>This will both add the Solana.Unity.Rpc as a dependency to the created project, and restore the NuGet dependencies.</p>
<p>Now we're ready to dive into the code.</p>
<h2 id="2--creating-a-wallet">2- Creating a wallet</h2>
<p>Now lets dive into the code. The first thing you want to do is create a new Wallet.
To do this, lets start by bringing into scope a couple namespaces related to the Wallets and their generation, and then create a Wallet from a Bip39 mnemonic.</p>
<pre><code>using Solana.Unity.Wallet;
using Solana.Unity.Wallet.Bip39;
</code></pre>
<p>And then inside the main function:</p>
<pre><code>Wallet wallet = new Wallet(WordCount.TwentyFour, WordList.English);

Console.WriteLine($&quot;Mnemonic: {wallet.Mnemonic}&quot;);
Console.WriteLine($&quot;PubKey: {wallet.Account.PublicKey.Key}&quot;);
Console.WriteLine($&quot;PrivateKey: {wallet.Account.PrivateKey.Key}&quot;);
</code></pre>
<p><strong>Note: always protect your private keys and Mnemonic!</strong></p>
<p><strong>Note2: every time you restart your program, this Wallet constructor will generate a new wallet, so save your keys (mnemonic) if you don't want to lose funds.</strong></p>
<p>With this, you have successfully generated a new Wallet. If you had any existing wallet that you want to use, look into the Wallet <a href="../api/Solana.Unity.Wallet.Wallet.html">constructor overloads</a>.
Now that we have initialized a wallet, you have access to an Account, and possibly <em>infinite</em> amounts of derivated accounts. With this, we can move on to make actual RPC requests.</p>
<h2 id="3--rpc-client">3- Rpc Client</h2>
<p>With the following code, we can initialize an <c>IRpcClient</c> that connects to the <a href="https://docs.solana.com/clusters">TestNet</a>. The ClientFactory class allows you to create both IRpcClient and IStreamingRpcClient objects and select from known public clusters or any private you have access to.</p>
<pre><code>using Solana.Unity.Rpc;
</code></pre>
<pre><code>IRpcClient rpcClient = ClientFactory.GetClient(Cluster.TestNet);
</code></pre>
<p>The IRpcClient interface contains all the available JsonRpc methods in the solana API. Lets start with querying the balance of our generated wallet.</p>
<pre><code>var balance = rpcClient.GetBalance(wallet.Account.PublicKey);

Console.WriteLine($&quot;Balance: {balance.Result.Value}&quot;);
</code></pre>
<p>As you guessed, we just generated the account, so the balance is obviously 0.
To help during development tasks, there is a special RPC method <a href="https://docs.solana.com/developing/clients/jsonrpc-api#requestairdrop">requestAirdrop</a> that is available in some clusters (DevNet and TestNet). Instead of spamming twitter and discord <i>airdrop wen</i> lets just request the test network for one :).</p>
<pre><code>var transactionHash = rpcClient.RequestAirdrop(wallet.Account.PublicKey, 100_000_000);

Console.WriteLine($&quot;TxHash: {transactionHash.Result}&quot;);
</code></pre>
<p>Some takeaways from the previous code:</p>
<ul>
<li>The request ammount sounds huge, be mindfull that 1 Sol = 1 Billion lamports. Both the balance and airdrop methods use lamports as units.</li>
<li>The requestAirdrop request returns a transaction hash. Only after about 1 minute will the funds be available (depending on <a href="https://docs.solana.com/developing/clients/jsonrpc-api#configuring-state-commitment">commitment parameter</a> levels)</li>
</ul>
<p>The delay between the request transaction and its confirmation means we can't do requests straight away that depend on having funds. That brings us to the next part.</p>
<h2 id="4--streaming-rpc-client">4- Streaming Rpc Client</h2>
<p>To start using the <code>IStreamingRpcClient</code> is very similar to the <code>IRpcClient</code>, just need to call the <code>ClientFactory</code> to construct a new client. Be mindful that you use the same cluster, or the streaming client won't know about the transaction you just created in another cluster using the other client.</p>
<pre><code>IStreamingRpcClient streamingRpcClient = ClientFactory.GetStreamingClient(Cluster.TestNet);

streamingRpcClient.ConnectAsync().Wait();
</code></pre>
<p>Now we are connected using WebSockets to the cluster and ready to subscribe to data changes. In this case, we'll subscribe to the transaction confirmation.</p>
<pre><code>var subscription = streamingRpcClient.SubscribeSignature(transactionHash.Result, (sub, data) =&gt;
{
    if(data.Value.Error == null)
    {
        var balance = rpcClient.GetBalance(wallet.Account.PublicKey);

        Console.WriteLine($&quot;Balance: {balance.Result.Value}&quot;);
    }
    else
    {
        Console.WriteLine($&quot;Transaction error: {data.Value.Error.Type}&quot;);
    }
});
</code></pre>
<p>With the streaming client, every method works the same. When you subscribe to any method, you receive a subscription state object (this object will allow you to unsubscribe at any time or to receive notifications about changes to the state of the subscription) and you need to pass an handle to a data handler method that receives a SubscriptionState and the data itself (with the <code>SubscriptionState</code> parameter, you can reuse your data handlers and still know which subscription triggered a given update).
Diving deeper into the example data handler, when you are notified its possible that there were errors with a given transaction, but if everything goes right, then the <code>Error</code> value should be null. And now requesting the balance should return the value requested.</p>
<p>Note: if your program keeps exiting before you receive the notification, add a <code>Console.ReadLine()</code> at the end of your program.</p>
<p>Given that we have balance on our wallet, we can now proceed to spend it. What could be better do than an actual &quot;Hello World&quot;?</p>
<h2 id="5--programs">5- Programs</h2>
<p>By now I hope you've read a bit about <a href="https://docs.solana.com/developing/on-chain-programs/overview">Solana Programs</a>. You don't need to understand it all, nor have to write rust to interact with them. But the gist of it, is that everything that happens inside the Solana blockchain is powered by some program. You want to transfer funds between two wallets? You call the <a href="https://docs.rs/solana-sdk/1.7.3/solana_sdk/system_instruction/enum.SystemInstruction.html#variant.Transfer">SystemProgram.Transfer</a> method. You want to deal with tokens? Theres several programs and methods ready-to-use in the <a href="https://spl.solana.com/token">SPL</a> waiting for you. For now, we're focusing on something very simple, we're going to use the <a href="https://spl.solana.com/memo">MemoProgram</a> to simply print a log message.</p>
<p>To start, we need to add the Solana.Unity.Programs package:</p>
<pre><code>dotnet add package Solana.Unity.Programs
</code></pre>
<p>This package contains the abstraction to call several native and SPL programs. Now lets not forget to bring the programs namespace into visibility.</p>
<pre><code>using Solana.Unity.Programs;
using Solana.Unity.Rpc.Builders;
</code></pre>
<p>To call a program, we have to send a transaction using the <code>IRpcClient.SendTransaction</code> method. But for this we need to craft a transaction. The <code>TransactionBuilder</code> was created with this in mind. This builder abstracts all the logic regarding <a href="https://docs.solana.com/developing/programming-model/transactions">transactions</a> (headers, signatures, public keys, etc) and allows you to craft a transaction using only 4 methods: Build, AddInstruction, SetFeePayer, SetRecentBlockHash. However, it is fully compliant with web3.js implementation, and you can craft a transaction using Solana.Unity and sign it elsewhere after calling CompileMessage.
To sum things nicely, a transaction is a collection of instructions, each transaction needs someone to pay the fees, and to prevent the network to be spammed we need a (very) recent block hash.</p>
<p>The Solana.Unity.Programs library, abstracts the usage of programs, and the creation of instructions that interact with these programs. For this example, we are using the static class <code>MemoProgram</code>.</p>
<p>Putting this together wew can quickly write:</p>
<pre><code>var memoInstruction = MemoProgram.NewMemo(wallet.Account, &quot;Hello Solana World, using Solana.Unity :)&quot;);

var recentHash = rpcClient.GetRecentBlockHash();

var tx = new TransactionBuilder()
            .AddInstruction(memoInstruction)
            .SetFeePayer(wallet.Account)
            .SetRecentBlockHash(recentHash.Result.Value.Blockhash)
            .Build(wallet.Account);

var txHash = rpcClient.SendTransaction(tx);

Console.WriteLine($&quot;TxHash: {txHash.Result}&quot;);
</code></pre>
<p>Now, if everything goes right, after a minute we can check that the transaction was confirmed and that the memo program executed our log.</p>
<p>To do this, you could either call the <code>IRpcClient.GetTransaction</code>, or you can double check outside of Solana.Unity to make sure everything matches. Go to <a href="https://explorer.solana.com">Solana Explorer </a>, select the TestNet and copy+paste the transaction hash.
You should be presented with all the details, and most important:</p>
<p><img src="imgs/memo.png" alt="Confirmed Transaction With Memo"></p>
<p><strong>Congratulations, you just called your first on-chain Solana program :)</strong></p>
<p>You can see the entire example on our <a href="https://github.com/garbles-dev/Solana.Unity/blob/master/src/Solana.Unity.Examples/HelloWorldExample.cs">github</a>.</p>
<p>Next steps:
See more <a href="https://github.com/garbles-dev/Solana.Unity/blob/master/src/Solana.Unity.Examples/">examples</a>.</p>
<p>Read the <a href="../api/Solana.Unity.Wallet.html">API</a>.</p>
</article>
              
                </div>
            </main>
        </div>

        
<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
<script type="text/javascript" src="../styles/jquery.twbsPagination.js"></script>
<script type="text/javascript" src="../styles/url.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script>
<script type="text/javascript" src="../styles/docfx.js"></script>
<script type="text/javascript" src="../styles/main.js"></script>

    </body>

</html>
